Тестовое задание индексбокс:

Написать скрипт test_task.py на Python 2.7, при запуске осуществляющий следующие действия:

1) Подключиться к БД (SQLite3, test.db):

2) Нам нужна таблица testidprod, она имеет вид:

Прямыми SQL запросами (без ORM-модели, курсором) забрать из таблицы testidprod данные из строк, где:
  `partner` это NULL;
  `state` тоже NULL;
  `bs`  =  0 ;
  `factor` = 1 и 2.

  И сформировать из них pandas.DataFrame следующего вида:

 Где: 
* столбцы — факторы, далее внутри каждого фактора годы 2006-2020 (factor и year соответственно);
* данные — значения res из БД, если там нету — numpy.nan;
* world — сумма значений res всех country по каждому фактору-году соответственно;

3) Добавить к датафрейму справа аналогичный фактор 6, представляющий из себя результат деления данных фактора 2 на данные фактора 1.

4) Сохранить датафрейм в эксель (report.xlsx) (рядом со скриптом)

5) Посчитать по фактору 6 — на сколько он рос/снижался (в среднем) за каждый год нашего диапазона (гугли CAGR).

6) Сохранить транспонированный датафрейм только с фактором 6 в ворд (report.docx) как таблицу, ниже дописать:
    «Factor 6 grew (или decreased) by avg {cagr}% every year from {s_year} to {e_year}.» , в зависимости от подсчета.

Примеры результата:
-report.docx
-report.xlsx

Приветствуются комментарии с разъяснениями выбранного алгоритма решения, с кратким перечнем других возможных вариантов, даже плохих (в разрезе сложности/простоты, оптимизации запросов/вычислений и т.д.)

Библиотеки: sqlite3, pandas, numpy, docxtpl/docx
